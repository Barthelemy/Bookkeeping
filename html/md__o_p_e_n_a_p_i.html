<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bookkeeping: OpenAPI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bookkeeping
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">OpenAPI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md41"></a>
Client generation</h1>
<p>Reference <a href="https://github.com/OpenAPITools/openapi-generator">OpenAPITools/openapi-generator</a> on how to generate a C++ (or any other language) client based on an OpenAPI specification. Note that the generated client is of course a best effort and can be incomplete or wrong.</p>
<h1><a class="anchor" id="autotoc_md42"></a>
Visualization of specification</h1>
<p>You can use the <a href="https://editor.swagger.io/">Swagger Editor</a> to visualize the OpenAPI specification. Load the <code>spec/openapi.yaml</code> and not the <code>spec/openapi-source.yaml</code>.</p>
<h1><a class="anchor" id="autotoc_md43"></a>
allOf and additionalProperties</h1>
<p>When you use <code>additionalProperties: false</code> on an <code>allOf</code> schema, it will only consider the schema where the <code>additionalProperties</code> property has been set, not the resulting merged schema.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
Specification</h2>
<div class="fragment"><div class="line">components:</div>
<div class="line">  schemas:</div>
<div class="line">    Entity:</div>
<div class="line">      type: object</div>
<div class="line">      properties:</div>
<div class="line">        id:</div>
<div class="line">          type: integer</div>
<div class="line">          format: int64</div>
<div class="line">      required:</div>
<div class="line">        - id</div>
<div class="line">    Log:</div>
<div class="line">      allOf:</div>
<div class="line">        - $ref: &quot;#/components/schemas/Model&quot;</div>
<div class="line">        - type: object</div>
<div class="line">          properties:</div>
<div class="line">            title:</div>
<div class="line">              type: string</div>
<div class="line">          required:</div>
<div class="line">            - title</div>
<div class="line">          additionalProperties: false</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md45"></a>
Response</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;id&quot;: 1,</div>
<div class="line">  &quot;title&quot;: &quot;Log #1&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md46"></a>
Result</h2>
<blockquote class="doxtable">
<p><b>Note:</b> When validating the data, servers and clients will validate the combined model against each model it consists of. It is recommended to avoid using conflicting properties (like properties that have the same names, but different data types). </p>
</blockquote>
<p>This implies that behavior is actually correctly. The two schemas are evaluated individually for the whole object, thus the <code>additionalProperties</code> will fail because it expects only the required <code>title</code> property but actually receives the combined model (thus both <code>id</code> and <code>title</code>).</p>
<h2><a class="anchor" id="autotoc_md47"></a>
Solution</h2>
<p>The <code>spec/convert.js</code> will convert <code>allOf</code> schema composition to a single schema. For the earlier provided specification the <code>Log</code> schema would result in the following:</p>
<div class="fragment"><div class="line">components:</div>
<div class="line">  schemas:</div>
<div class="line">    Entity:</div>
<div class="line">      type: object</div>
<div class="line">      properties:</div>
<div class="line">        id:</div>
<div class="line">          type: integer</div>
<div class="line">          format: int64</div>
<div class="line">      required:</div>
<div class="line">        - id</div>
<div class="line">    Log:</div>
<div class="line">      type: object</div>
<div class="line">      properties:</div>
<div class="line">        id:</div>
<div class="line">          type: integer</div>
<div class="line">          format: int64</div>
<div class="line">        title:</div>
<div class="line">          type: string</div>
<div class="line">      required:</div>
<div class="line">        - id</div>
<div class="line">        - title</div>
<div class="line">      additionalProperties: false</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
